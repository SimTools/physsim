/*
 * ############################################################################
 * ## (Description)
 * ##    Imake file for Anlib: C++ analysis library
 * ## (Update Record)
 * ##    99/05/22  K.Fujii     Original version.
 * ##    01/08/01  K.Ikematsu  Fixed dependency check for
 * ##                          generating dictionary.
 * ##
 * ## $Id$
 * ############################################################################
 *
 */

/* Template Files */

#define CXXPACKAGE
#include "../../config/kflib.tmpl"

/* Package Name */

INSTALLDIR	= ../../lib
LIBNAME		= JSFAnlib
SONAME		= lib$(LIBNAME).$(SOEXT).$(SOREV)
JSFSOLIB	= $(SONAME)

/* Headers */

INCPATH	= -I. -I$(ANLIBROOT)/include -I$(SATELLITESROOT)/include

/* Routines to compile */

OBJS		= ANLTrack.$(ObjSuf) \
		  ANLVTXTagger.$(ObjSuf) \
		  FlavourGetter.$(ObjSuf) \
		  ANLCheatedJetFinder.$(ObjSuf) \
		  ANLGVTXTagger.$(ObjSuf)

/* You don't have to edit anything below here */

DICTNAME	= $(LIBNAME)Dict

ALLOBJS 	= $(OBJS) $(DICTNAME).$(ObjSuf)

SRCS		= $(subst .$(ObjSuf),.$(SrcSuf),$(ALLOBJS))

HDRS		= $(subst .$(ObjSuf),.h,$(OBJS))

CXXFLAGS       += $(INCPATH)

/* Make Targets */

all:: $(JSFSOLIB)

$(JSFSOLIB): $(ALLOBJS)
	$(LD) -o $@ $(SOFLAGS) $(ALLOBJS)
	$(RM) $(subst .$(SOREV),,$@)
	$(LN) $@ $(subst .$(SOREV),,$@)

InstallSharedLibrary($(LIBNAME),$(SOREV),$(INSTALLDIR))

$(DICTNAME).$(ObjSuf): $(DICTNAME).$(SrcSuf)

clean::
	@rm -f *.$(ObjSuf) core $(DICTNAME).$(SrcSuf) $(DICTNAME).h

depend:: $(SRCS) $(HDRS)
	for i in $(SRCS); do \
	rmkdepend -a -- $(CXXFLAGS) $(INCPATH) $(DEPENDFILES) -- $$i; done

distclean:: clean
	@rm -f $(JSFSOLIB) *.$(SOEXT) Makefile
	@rm -f *.root *.tdr *.out *~ core

$(DICTNAME).$(SrcSuf): $(HDRS) LinkDef.h
	@echo "Generating dictionary ..."
	rootcint -f $(DICTNAME).$(SrcSuf) \
 		-c -I$(JSFROOT)/include -I$(ANLIBROOT)/include \
		   -I$(SATELLITESROOT)/include $(RCINTDEFINES) $(HDRS) LinkDef.h
