C
C  *INCLUDE UDSRCH
C        WRITE(21,'(''NEWFRAME'')')
C        WRITE(21,'(''SET ORDER X Y'')')
C        DO 10 I = 1, 100
C           X = 0.01*I
C           CALL RSHDIS(X,1,Y)
C           WRITE(21,'(2E15.8)') Y, X
C  10    CONTINUE
C        WRITE(21,'(''JOIN'')')
C        END
C*
C* This version for JLC-I X-band(150) parameter as of 93/04/18
C* with the bremsstrahlung:
C*                   _
C*                  / 1
C*    sig_RC(s) =  /   dz b [ z**(b-1)(1+3b/4) - (1-z/2) ] sig((1-z)s)
C*               _/ 0
C* The beam energy spread is assumed to be flat and has FWHM of 0.4%.
C*
      SUBROUTINE RSHDIS(X,ITYP,Y)
 
      IMPLICIT   REAL*8 ( A-H, O-Z )
      INTEGER*4  ITYP
      REAL   *4  X, Y
C--
      DATA   SGEB / 0.002D0 /
      PARAMETER  ( MXxDAT = 111 )
      REAL   *8  BMDATA(2,0:MXxDAT)
      DATA ( BMDATA(I,0),I=1,2) /  2*0.D0 /
      DATA ((BMDATA(I,J),I=1,2),J= 1,20) /
     . 0.34872303D-03, 0.29999997D-01, 0.11087323D-02, 0.89999974D-01,
     . 0.22621274D-02, 0.14999998D+00, 0.37356205D-02, 0.20999998D+00,
     . 0.54801144D-02, 0.26999998D+00, 0.73662437D-02, 0.32999998D+00,
     . 0.94921254D-02, 0.38999999D+00, 0.11899222D-01, 0.44999999D+00,
     . 0.14425103D-01, 0.50999999D+00, 0.17117057D-01, 0.56999999D+00,
     . 0.19938052D-01, 0.63000000D+00, 0.22906542D-01, 0.69000000D+00,
     . 0.26075095D-01, 0.75000000D+00, 0.29443908D-01, 0.80999994D+00,
     . 0.32942165D-01, 0.86999995D+00, 0.36605582D-01, 0.92999995D+00,
     . 0.40397625D-01, 0.98999995D+00, 0.44323921D-01, 0.10499992D+01,
     . 0.48424058D-01, 0.11099997D+01, 0.52723117D-01, 0.11699991D+01/
      DATA ((BMDATA(I,J),I=1,2),J=21,40) /
     . 0.57171024D-01, 0.12299995D+01, 0.61890502D-01, 0.12900000D+01,
     . 0.66760659D-01, 0.13499994D+01, 0.71891010D-01, 0.14099998D+01,
     . 0.77218354D-01, 0.14699993D+01, 0.82761645D-01, 0.15299997D+01,
     . 0.88664055D-01, 0.15899992D+01, 0.94876528D-01, 0.16499996D+01,
     . 0.10149640D+00, 0.17099991D+01, 0.10836083D+00, 0.17699995D+01,
     . 0.11574543D+00, 0.18299999D+01, 0.12343556D+00, 0.18899994D+01,
     . 0.13174486D+00, 0.19499998D+01, 0.14026845D+00, 0.20099993D+01,
     . 0.14927959D+00, 0.20699997D+01, 0.15851170D+00, 0.21299992D+01,
     . 0.16821045D+00, 0.21899996D+01, 0.17817253D+00, 0.22500000D+01,
     . 0.18856013D+00, 0.23099995D+01, 0.19914991D+00, 0.23699999D+01/
      DATA ((BMDATA(I,J),I=1,2),J=41,60) /
     . 0.21017957D+00, 0.24299994D+01, 0.22138435D+00, 0.24899998D+01,
     . 0.23288983D+00, 0.25499992D+01, 0.24444348D+00, 0.26099997D+01,
     . 0.25621867D+00, 0.26699991D+01, 0.26822597D+00, 0.27299995D+01,
     . 0.28037095D+00, 0.27900000D+01, 0.29268837D+00, 0.28499994D+01,
     . 0.30517548D+00, 0.29099998D+01, 0.31753296D+00, 0.29699993D+01,
     . 0.32377291D+00, 0.30149994D+01, 0.33002597D+00, 0.30449991D+01,
     . 0.33640146D+00, 0.30749998D+01, 0.34270358D+00, 0.31049995D+01,
     . 0.34895188D+00, 0.31349993D+01, 0.35524684D+00, 0.31650000D+01,
     . 0.36168349D+00, 0.31949997D+01, 0.36804092D+00, 0.32249994D+01,
     . 0.37434411D+00, 0.32549992D+01, 0.38058639D+00, 0.32849998D+01/
      DATA ((BMDATA(I,J),I=1,2),J=61,80) /
     . 0.38697171D+00, 0.33149996D+01, 0.39327949D+00, 0.33449993D+01,
     . 0.39964056D+00, 0.33750000D+01, 0.40603775D+00, 0.34049997D+01,
     . 0.41242743D+00, 0.34349995D+01, 0.41885662D+00, 0.34649992D+01,
     . 0.42533195D+00, 0.34949999D+01, 0.43183059D+00, 0.35249996D+01,
     . 0.43836361D+00, 0.35549994D+01, 0.44494408D+00, 0.35849991D+01,
     . 0.45145935D+00, 0.36149998D+01, 0.45798957D+00, 0.36449995D+01,
     . 0.46454149D+00, 0.36749992D+01, 0.47114170D+00, 0.37049999D+01,
     . 0.47782344D+00, 0.37349997D+01, 0.48453295D+00, 0.37649994D+01,
     . 0.49135542D+00, 0.37949991D+01, 0.49816173D+00, 0.38249998D+01,
     . 0.50508583D+00, 0.38549995D+01, 0.51200545D+00, 0.38849993D+01/
      DATA ((BMDATA(I,J),I=1,2),J=81,100) /
     . 0.51896149D+00, 0.39150000D+01, 0.52605242D+00, 0.39449997D+01,
     . 0.53314030D+00, 0.39749994D+01, 0.54040879D+00, 0.40049992D+01,
     . 0.54784346D+00, 0.40349998D+01, 0.55537283D+00, 0.40649996D+01,
     . 0.56301534D+00, 0.40949993D+01, 0.57072675D+00, 0.41250000D+01,
     . 0.57872158D+00, 0.41549997D+01, 0.58703697D+00, 0.41849995D+01,
     . 0.59563160D+00, 0.42149992D+01, 0.60449845D+00, 0.42449999D+01,
     . 0.61377794D+00, 0.42749996D+01, 0.62363935D+00, 0.43049994D+01,
     . 0.63404334D+00, 0.43349991D+01, 0.64550561D+00, 0.43649998D+01,
     . 0.65818352D+00, 0.43949995D+01, 0.67490834D+00, 0.44249992D+01,
     . 0.69942880D+00, 0.44549999D+01, 0.73059851D+00, 0.44849997D+01/
      DATA ((BMDATA(I,J),I=1,2),J=101,111) /
     . 0.76752800D+00, 0.45149994D+01, 0.80827951D+00, 0.45449991D+01,
     . 0.85167241D+00, 0.45749998D+01, 0.89337420D+00, 0.46049995D+01,
     . 0.92741650D+00, 0.46349993D+01, 0.95363420D+00, 0.46650000D+01,
     . 0.97317225D+00, 0.46949997D+01, 0.98665255D+00, 0.47249994D+01,
     . 0.99513501D+00, 0.47549992D+01, 0.99927008D+00, 0.47849998D+01,
     . 0.99999994D+00, 0.48149996D+01/
C
C========< Entry Point >================================================
C
C--
C  Decide which bin X belongs to.
C--
      CALL UDSRCH(MXxDAT,2,1,BMDATA(1,1),DBLE(X),IP)
C--
C  Calculate Y.
C     FRAC = MAX(1.E-6,1+5*SGEB-FRAC)
C     FRAC = -LOG(FRAC)
C--
      IF ( IP.NE.0 .AND. IP.NE.MXxDAT ) THEN
         XL  = BMDATA(1,IP)
         DX  = BMDATA(1,IP+1) - XL
         DF  = (BMDATA(2,IP+1)-BMDATA(2,IP))/DX
         VAL = BMDATA(2,IP) + (X-XL)*DF
      ELSE
         VAL = BMDATA(2,IP)
      ENDIF
      Y   = 1 + 5*SGEB - EXP(-VAL)
C--
C  That's it.
C--
      RETURN
      END
